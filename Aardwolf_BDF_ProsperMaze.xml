<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Monday, October 03, 2022, 7:49 PM -->
<!-- MuClient version 5.07-pre -->

<!-- Plugin "Aardwolf_BDF_ProsperMaze" generated by Plugin Wizard -->

<muclient>
<plugin
   name="Aardwolf_BDF_ProsperMaze"
   author="Pmage"
   id="c94711671431e31a7a9f22c3"
   language="Lua"
   purpose="Prosper Cexits"
   save_state="y"
   date_written="2022-10-03 19:47:11"
   requires="5.07"
   version="1.0"
   >
<description trim="y">
<![CDATA[
    Credit: Idea is from originaly from Astral flames, adapted to Prosper. 
Tweaked for running through multiple cexits.
additional reference:
http://www.gammon.com.au/forum/bbshowpost.php?bbsubject_id=4957
https://www.gammon.com.au/forum/?id=4957
]]>
</description>

</plugin>
	<variables>
<!--  Variable  -->
	<variable name="prosperSW">nil</variable>

	</variables>

	<!--  Aliases  -->
	<!-- Helpersx2 -->
<aliases>
	<alias
		match="^(pros|prosp|prospe|prosper) (h|he|hel|help)$"
		enabled="y"
		regexp="y"
		script="OnHelp"
		sequence="99"
		ignore_case="y"
		send_to="12"
>
		<send>
		</send>
	</alias>
	
	<alias
	script="OnHelp"
	match="Aardwolf_BDF_ProsperMaze:help"
	enabled="y"
>
	</alias>
	
<!-- prospthea -->
  <alias
	name="EnteringtheTheater" 
	match="prospthea"  
	enabled="y"
	group="ProsperMaze"
	send_to="12"
	sequence="100"
  >
	<send>
		require "wait"
		wait.make (function() -- start of coroutine
			Send ("exits")
			targroom = wait.match("*Entering the Theater*", 5)
			dir = string.sub (targroom, 2, 4)
			Send (dir)
		end) -- of Coroutine
	</send>
  </alias>
	
<!-- prospact1 -->
  <alias
	name="ActISceneII"
	match="prospact1"  
	enabled="y"
	group="ProsperMaze"
	send_to="12"
	sequence="100"
	  >
	<send>
		require "wait"
		wait.make (function() -- start of coroutine
		Send ("exits")
		targroom = wait.match("*Intruding upon 'Act I, Scene II'*", 5)
		dir = string.sub (targroom, 2, 4)
		Send (dir)
		end) -- of Coroutine
		sleep(1)
	</send>
  </alias>

<!-- prospimag -->
  <alias
	name="Imaginarium"
	match="prospimag"  
	enabled="y"
	group="ProsperMaze"
	send_to="12"
	sequence="100"
	  >
  <send>
	  require "wait"
	  wait.make (function() -- start of coroutine
	  Send ("exits")
	  targroom = wait.match("*The Imaginarium*", 5)
	  dir = string.sub (targroom, 2, 4)
	  Send (dir)
	  end) -- of Coroutine

  </send>
  </alias>

	<!-- prosptrib -->
  <alias
   name="OnaTribune"
   match="prosptrib" 
   enabled="y"
   group="ProsperMaze"
   send_to="12"
   sequence="100"
  >
	  <send>
		  require "wait"
		  wait.make (function() -- start of coroutine
		  Send ("exits")
		  targroom = wait.match("*On a Tribune*", 5)
		  dir = string.sub (targroom, 2, 4)
		  Send (dir)
		  end) -- of Coroutine

	  </send>
  </alias>

	<!-- prospdres -->
  <alias
   name="ADressingRoom"
   match="prospdres"  
   enabled="y"
   group="ProsperMaze"
   send_to="12"
   sequence="100"
  >
	  <send>
		  require "wait"
		  wait.make (function() -- start of coroutine
		  Send ("exits")
		  targroom = wait.match("*A Dressing Room*", 5)
		  dir = string.sub (targroom, 2, 4)
		  Send (dir)
		  end) -- of Coroutine

	  </send>
	  </alias>

	<!-- prospplay -->
  <alias
   name="PlayThing"
   match="prospplay" 	  
   enabled="y"
   group="ProsperMaze"
   send_to="12"
   sequence="100"
  >
  <send>
	  require "wait"
	  wait.make (function() -- start of coroutine
	  Send ("exits")
	  targroom = wait.match("*The Play is the Thing*", 5)
	  dir = string.sub (targroom, 2, 4)
	  Send (dir)
	  end) -- of Coroutine

  </send>
  </alias>

	<!-- prospstage -->
  <alias
   name="BehindtheStage"
   match="prospstage" 
   enabled="y"
   group="ProsperMaze"
   send_to="12"
   sequence="100"
  >
  <send>
	  require "wait"
	  wait.make (function() -- start of coroutine
	  Send ("exits")
	  targroom = wait.match("*Behind the Stage  [*", 5)
	  dir = string.sub (targroom, 2, 4)
	  Send (dir)
	  end) -- of Coroutine

  </send>
  </alias>

	<!-- prospline -->
  <alias
   name="StandinginLine"
   match="prospline"	 
   enabled="y"
   group="ProsperMaze"
   send_to="12"
   sequence="100"
  >
  <send>
	  require "wait"
	  wait.make (function() -- start of coroutine
	  Send ("exits")
	  targroom = wait.match("*Standing in Line*", 5)
	  dir = string.sub (targroom, 2, 4)
	  Send (dir)
	  end) -- of Coroutine

  </send>
  </alias>

	<!-- prospbrid -->
  <alias
   name="OnTheBridge"
   match="prospbrid"
   enabled="y"
   group="ProsperMaze"
   send_to="12"
   sequence="100"
  >
  <send>
	  require "wait"
	  wait.make (function() -- start of coroutine
	  Send ("exits")
	  targroom = wait.match("*On 'The Bridge'*", 5)
	  dir = string.sub (targroom, 2, 4)
	  Send (dir)
	  end) -- of Coroutine

  </send>
  </alias>


	<!-- prospdark -->
  <alias
   name="ADarkRoom"
   match="prospdark"
   enabled="y"
   group="ProsperMaze"
   send_to="12"
   sequence="100"
  >
  <send>
	  require "wait"
	  wait.make (function() -- start of coroutine
	  Send ("exits")
	  targroom = wait.match("*A Dark Room*", 5)
	  dir = string.sub (targroom, 2, 4)
	  Send (dir)
	  end) -- of Coroutine

  </send>
  </alias>

	<!-- prospstor -->
  <alias
   name="AStorageRoom"
   match="prospstor"
   enabled="y"
   group="ProsperMaze"
   send_to="12"
   sequence="100"
  >
  <send>
	  require "wait"
	  wait.make (function() -- start of coroutine
	  Send ("exits")
	  targroom = wait.match("*A Storage Room*", 5)
	  dir = string.sub (targroom, 2, 4)
	  Send (dir)
	  end) -- of Coroutine

  </send>
  </alias>

</aliases>

<!--  Plugin help  -->



<script>
<![CDATA[
function OnHelp ()
  world.Note (world.GetPluginInfo (world.GetPluginID (), 3))
--  print(" ******** Please check 'prosper help' ******** " )
  local help = [[
  
			                          BDF Prosper Maze Help
			=============================================================================
			               prosper help       -->        Show this help
			-----------------------------------------------------------------------------
			You will need to visit all prosper maze rooms enough times to map each exit,
			in each room. "mapper cexit aliasforexit;;wait(1)" replacing aliasforexit with
			whichever exit you need. There is one room that two of the exits can't be done.
			That is 28258 - Adressing room which as 2 exits to the same name. 
			The alias names are pretty self explanatory but I will list them here.
			=============================================================================
			cexit       --> Room                            --> Room#
			prospimag   --> The Imaginarium	(lemdagor)      --> 2010 
			prospplay   --> The Play is the Thing (start)   --> 28257
			prospstor   --> A Storage Room                  --> 28261
			prospdark   --> A Dark Room	                    --> 28263
			prospbrid   --> On 'The Bridge                  --> 28260
			prospline   --> Standing in Line                --> 28253
			prospstage  --> Behind the Stage                --> 28259, 28262, 28255
			prospdres   --> A Dressing Room                 --> 28258 (don't map 2 maze rooms here)
			prosptrib   --> On a Tribune                    --> 28252
			prospact1   --> Intruding upon 'Act I, Scene II --> 28254
			prospthea   --> Entering the Theater            --> 28256 (not maze - can gmcp)
			=============================================================================
			------------------------------None Maze Rooms--------------------------------
			Room                --> Room#
			In Stalwart's Room  --> 28264
			In Brawn's Room     --> 28265
			At 'The Bridge'?    --> 28266
			----------------------------------------------------------------------------
			**********Bonus Tips 
			-->   Entering theater has down exit to imaginarium, and vise versa
			-->   Use "mapper thisroom" to see mapped exits (suggest alias like mhere)
			============================================================================
			]]
			print(help)
end

function OnPluginInstall()
	print("Plugin Initialized: " .. GetPluginName() )
	world.Note (world.GetPluginInfo (world.GetPluginID (), 3))
	print("\n ******** Please check 'prosper help' ******** \n" )
end --onplugin install 

-- don't use but good code
local clock = os.clock
function sleep(n) -- seconds
  local t0 = clock()
  while clock() - t0 <= n do end
end --  clock


]]>
</script> 

</muclient>
